import{d as $,a as s,x as j,q,c as x,b as I,H as G,e,w as u,k as H,I as J,G as L,J as K,K as R,n as r,C as W,o as _,l as c,D as X,L as Q,F as Y,g as Z,i as ee,j as ae,M as le,N as te,O as oe,P as ue,Q as re,_ as de}from"./index-CWo0abK5.js";/* empty css                  *//* empty css               *//* empty css                 *//* empty css                *//* empty css                        */import"./el-form-item-l0sNRNKZ.js";import{p as ne,u as se,c as ie}from"./product-B2KrNTYH.js";import{g as pe}from"./category-8I9ytzQF.js";import"./http-CaWKIfWx.js";const me={class:"products-container"},ce={class:"header"},ve={class:"dialog-footer"},fe=$({__name:"Products",setup(be){const N=s([]),y=s(!1),i=s(!1),V=s([]),f=s(1),E=s(10),k=s(0),a=s({productId:0,productName:"",categoryId:"",categoryName:"",brand:"",price:0,barcode:"",stockQuantity:0,status:"售罄",unit:"",shelfLife:0,createTime:"",updateTime:"",minQuantity:0}),p=s(!1),T=()=>{p.value=!1,a.value={productId:0,productName:"",categoryId:"",categoryName:"",brand:"",price:0,barcode:"",stockQuantity:0,shelfLife:0,minQuantity:0,status:"售罄",unit:"",createTime:"",updateTime:""},i.value=!0},U=o=>{p.value=!0,a.value={...o},i.value=!0},P=()=>{p.value?a.value.brand.trim()===""?r.error("品牌不能为空"):a.value.price<=0?r.error("价格必须大于0"):a.value.barcode.trim()===""?r.error("条形码不能为空"):se({id:a.value.productId,...a.value}).then(o=>{o.data.code==="200"?(r.success(o.data.data),i.value=!1,v()):r.error(o.data.data)}):a.value.productName.trim()===""?r.error("商品名称不能为空"):a.value.categoryId===0?r.error("请选择分类"):a.value.brand.trim()===""?r.error("品牌不能为空"):a.value.price<=0?r.error("价格必须大于0"):a.value.barcode.trim()===""?r.error("条形码不能为空"):a.value.stockQuantity<0?r.error("库存不能小于0"):a.value.unit.trim()===""?r.error("单位不能为空"):ie(a.value).then(o=>{o.data.code==="200"?(r.success(o.data.data),i.value=!1,v()):r.error(o.data.data)})},z=async()=>{try{const o=await pe();o.data.code==="200"&&(V.value=o.data.data)}catch{r.error("获取分类列表失败")}},v=async()=>{y.value=!0;const o=await ne({page:f.value,size:E.value});o.data.code==="200"?(N.value=o.data.data.records,k.value=o.data.data.total,y.value=!1):r.error("获取商品失败")},S=o=>{f.value=o,v()},B=o=>{E.value=o,f.value=1,v()};return j(()=>a.value.categoryId,o=>{const l=V.value.find(m=>m.categoryId===o);l&&(a.value.categoryName=l.categoryName)}),q(()=>{v(),z()}),(o,l)=>{const m=H,d=X,D=Y,F=W,b=ae,n=ee,g=re,w=le,C=ue,M=Z,h=K,A=R,O=J;return _(),x("div",me,[I("div",ce,[l[12]||(l[12]=I("h2",null,"商品管理",-1)),e(m,{type:"primary",onClick:T},{default:u(()=>l[11]||(l[11]=[c("添加商品")])),_:1})]),G((_(),L(F,{data:N.value,style:{width:"100%",height:"90%"},"row-style":{height:"70px"}},{default:u(()=>[e(d,{prop:"productName",label:"商品名称"}),e(d,{prop:"categoryName",label:"分类"}),e(d,{prop:"barcode",label:"条形码"}),e(d,{prop:"brand",label:"品牌"}),e(d,{prop:"price",label:"价格"},{default:u(t=>[c(" ¥"+Q(t.row.price.toFixed(2)),1)]),_:1}),e(d,{prop:"minQuantity",label:"最少库存"}),e(d,{prop:"stockQuantity",label:"库存"}),e(d,{prop:"unit",label:"单位"}),e(d,{prop:"shelfLife",label:"保质期/月"}),e(d,{prop:"createTime",label:"创建时间"}),e(d,{prop:"updateTime",label:"更新时间"}),e(d,{prop:"status",label:"状态"},{default:u(t=>[e(D,{type:t.row.status==="可用"?"success":"danger"},{default:u(()=>[c(Q(t.row.status),1)]),_:2},1032,["type"])]),_:1}),e(d,{label:"操作",width:"200"},{default:u(t=>[e(m,{size:"small",onClick:ge=>U(t.row)},{default:u(()=>l[13]||(l[13]=[c("编辑")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[O,y.value]]),e(h,{modelValue:i.value,"onUpdate:modelValue":l[10]||(l[10]=t=>i.value=t),title:"商品信息",width:"500px"},{footer:u(()=>[I("span",ve,[e(m,{onClick:l[9]||(l[9]=t=>i.value=!1)},{default:u(()=>l[14]||(l[14]=[c("取消")])),_:1}),e(m,{type:"primary",onClick:P},{default:u(()=>l[15]||(l[15]=[c("确定")])),_:1})])]),default:u(()=>[e(M,{model:a.value,"label-width":"100px"},{default:u(()=>[e(n,{label:"商品名称"},{default:u(()=>[e(b,{modelValue:a.value.productName,"onUpdate:modelValue":l[0]||(l[0]=t=>a.value.productName=t),disabled:p.value},null,8,["modelValue","disabled"])]),_:1}),e(n,{label:"分类"},{default:u(()=>[e(w,{modelValue:a.value.categoryId,"onUpdate:modelValue":l[1]||(l[1]=t=>a.value.categoryId=t),placeholder:"请选择分类"},{default:u(()=>[(_(!0),x(te,null,oe(V.value,t=>(_(),L(g,{key:t.categoryId,label:t.rootCategoryName,value:t.categoryId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"品牌"},{default:u(()=>[e(b,{modelValue:a.value.brand,"onUpdate:modelValue":l[2]||(l[2]=t=>a.value.brand=t)},null,8,["modelValue"])]),_:1}),e(n,{label:"价格"},{default:u(()=>[e(C,{modelValue:a.value.price,"onUpdate:modelValue":l[3]||(l[3]=t=>a.value.price=t),precision:2,step:.1},null,8,["modelValue"])]),_:1}),e(n,{label:"条形码"},{default:u(()=>[e(b,{modelValue:a.value.barcode,"onUpdate:modelValue":l[4]||(l[4]=t=>a.value.barcode=t)},null,8,["modelValue"])]),_:1}),e(n,{label:"最少库存"},{default:u(()=>[e(C,{modelValue:a.value.minQuantity,"onUpdate:modelValue":l[5]||(l[5]=t=>a.value.minQuantity=t),min:0,disabled:p.value},null,8,["modelValue","disabled"])]),_:1}),e(n,{label:"单位"},{default:u(()=>[e(b,{modelValue:a.value.unit,"onUpdate:modelValue":l[6]||(l[6]=t=>a.value.unit=t),disabled:p.value},null,8,["modelValue","disabled"])]),_:1}),e(n,{label:"保质期/月"},{default:u(()=>[e(C,{modelValue:a.value.shelfLife,"onUpdate:modelValue":l[7]||(l[7]=t=>a.value.shelfLife=t),min:0},null,8,["modelValue"])]),_:1}),e(n,{label:"状态"},{default:u(()=>[e(w,{modelValue:a.value.status,"onUpdate:modelValue":l[8]||(l[8]=t=>a.value.status=t),disabled:!p.value},{default:u(()=>[e(g,{label:"可用",value:"可用"}),e(g,{label:"下架",value:"下架"}),e(g,{label:"售罄",value:"售罄"})]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(A,{"current-page":f.value,"page-size":10,total:k.value,layout:"prev, pager, next",background:"",style:{"margin-top":"5px"},onCurrentChange:S,onSizeChange:B},null,8,["current-page","total"])])}}}),Le=de(fe,[["__scopeId","data-v-6a39adf1"]]);export{Le as default};
