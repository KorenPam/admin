import{d as $,a as u,q as M,c as P,b as V,H as F,e as a,w as n,k as R,I as j,G as q,K as A,J as G,n as s,C as H,o as C,l as c,D as J,g as K,i as L,j as X,X as O,_ as Q}from"./index-CWo0abK5.js";/* empty css                  *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                 *//* empty css               */import{p as W,r as Y,u as Z,c as ee}from"./supplier-CIHb-u2x.js";import"./http-CaWKIfWx.js";const ae={class:"suppliers-container"},le={class:"header"},te={class:"dialog-footer"},oe=$({__name:"Suppliers",setup(ne){const w=u([]),f=u(1),_=u(10),x=u(0),b=u(!1),d=u(!1),g=u(!1),l=u({supplierId:null,supplierName:"",contact:"",phone:"",email:"",address:""}),i=async()=>{b.value=!0;try{const t=await W({page:f.value,size:_.value});t.data.code==="200"?(w.value=t.data.data.records,x.value=t.data.data.total):s.error("获取供应商失败")}catch{s.error("请求失败")}finally{b.value=!1}},h=t=>{f.value=t,i()},y=t=>{_.value=t,f.value=1,i()},E=()=>{g.value=!1,l.value={supplierId:null,supplierName:"",contact:"",phone:"",email:"",address:""},d.value=!0},k=t=>{g.value=!0,l.value={...t},d.value=!0},N=t=>{O.confirm("确认删除该供应商吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Y(t.supplierId).then(e=>{e.data.code==="200"?(s.success(e.data.data),i()):s.error(e.data.data)})})},z=()=>{if(l.value.supplierName.trim()===""){s.error("供应商名称不能为空");return}if(l.value.contact.trim()===""){s.error("联系人不能为空");return}const t=/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/;if(!l.value.email){s.error("邮箱不能为空");return}if(!t.test(l.value.email)){s.error("邮箱格式不正确");return}const e=/^1[3-9]\d{9}$/;if(l.value.phone&&!e.test(l.value.phone)){s.error("手机号格式不正确");return}if(l.value.address.trim()===""){s.error("地址不能为空");return}g.value?Z(l.value).then(r=>{r.data.code==="200"?(s.success(r.data.data),d.value=!1,i()):s.error(r.data.data)}):ee(l.value).then(r=>{r.data.code==="200"?(s.success(r.data.data),d.value=!1,i()):s.error(r.data.data)})};return M(()=>{i()}),(t,e)=>{const r=R,p=J,B=H,I=A,m=X,v=L,S=K,U=G,D=j;return C(),P("div",ae,[V("div",le,[e[8]||(e[8]=V("h2",null,"供应商管理",-1)),a(r,{type:"primary",onClick:E},{default:n(()=>e[7]||(e[7]=[c("添加供应商")])),_:1})]),F((C(),q(B,{data:w.value,style:{width:"100%",height:"90%"},"row-style":{height:"70px"}},{default:n(()=>[a(p,{prop:"supplierName",label:"名称"}),a(p,{prop:"contact",label:"联系人"}),a(p,{prop:"phone",label:"电话"}),a(p,{prop:"email",label:"邮箱"}),a(p,{prop:"address",label:"地址"}),a(p,{label:"操作",width:"180"},{default:n(o=>[a(r,{size:"small",onClick:T=>k(o.row)},{default:n(()=>e[9]||(e[9]=[c("编辑")])),_:2},1032,["onClick"]),a(r,{size:"small",type:"danger",onClick:T=>N(o.row)},{default:n(()=>e[10]||(e[10]=[c("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[D,b.value]]),a(I,{"current-page":f.value,"page-size":_.value,total:x.value,background:"",style:{"margin-top":"5px","text-align":"right"},layout:"prev, pager, next",onCurrentChange:h,onSizeChange:y},null,8,["current-page","page-size","total"]),a(U,{modelValue:d.value,"onUpdate:modelValue":e[6]||(e[6]=o=>d.value=o),title:g.value?"编辑供应商":"添加供应商",width:"500px"},{footer:n(()=>[V("div",te,[a(r,{onClick:e[5]||(e[5]=o=>d.value=!1)},{default:n(()=>e[11]||(e[11]=[c("取消")])),_:1}),a(r,{type:"primary",onClick:z},{default:n(()=>e[12]||(e[12]=[c("确定")])),_:1})])]),default:n(()=>[a(S,{model:l.value,"label-width":"100px"},{default:n(()=>[a(v,{label:"名称"},{default:n(()=>[a(m,{modelValue:l.value.supplierName,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.supplierName=o)},null,8,["modelValue"])]),_:1}),a(v,{label:"联系人"},{default:n(()=>[a(m,{modelValue:l.value.contact,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.contact=o)},null,8,["modelValue"])]),_:1}),a(v,{label:"电话"},{default:n(()=>[a(m,{modelValue:l.value.phone,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.phone=o)},null,8,["modelValue"])]),_:1}),a(v,{label:"邮箱"},{default:n(()=>[a(m,{modelValue:l.value.email,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.email=o)},null,8,["modelValue"])]),_:1}),a(v,{label:"地址"},{default:n(()=>[a(m,{modelValue:l.value.address,"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.address=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ce=Q(oe,[["__scopeId","data-v-e88088fc"]]);export{ce as default};
