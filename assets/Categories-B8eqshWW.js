import{d as M,a as r,q as j,c as F,b as C,H as E,e as t,w as n,k as O,I as q,G as A,J as G,K as H,n as d,C as J,o as k,l as p,D as K,L as Q,R as W,g as X,i as Y,j as Z,S as ee,_ as ae}from"./index-CWo0abK5.js";/* empty css                  *//* empty css               *//* empty css                 *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import{a as te,u as le,c as oe}from"./category-8I9ytzQF.js";import"./http-CaWKIfWx.js";const ne={class:"categories-container"},re={style:{display:"flex","justify-content":"space-between","align-items":"center"}},se={class:"dialog-footer"},de=M({__name:"Categories",setup(ie){const f=r(!1),i=r(!1),m=r(!1),g=r([]),V=r({label:"categoryName",value:"categoryId"}),b=r(),v=r(1),_=r(10),I=r(0),l=r({categoryId:0,categoryName:"",description:"",parentId:null,parentName:null,sortOrder:0}),h=a=>{m.value=!1;const e=a?a.categoryId:null;l.value={categoryId:null,categoryName:"",description:"",parentId:e,parentName:null,sortOrder:0},i.value=!0},x=a=>{m.value=!0,l.value={...a},i.value=!0},N=()=>{m.value?l.value.categoryName.trim()===""?d.error("类别名称不能为空"):l.value.parentId===l.value.categoryId?d.error("不能选择自己为父类别"):le({id:l.value.categoryId,...l.value}).then(a=>{a.data.code==="200"?(d.success(a.data.data),i.value=!1,c()):d.error(a.data.data)}):l.value.categoryName.trim()===""?d.error("类别名称不能为空"):oe(l.value).then(a=>{a.data.code==="200"?(d.success(a.data.data),i.value=!1,c()):d.error(a.data.data)})},c=async()=>{f.value=!0;const a=await te({page:v.value,size:_.value});a.data.code==="200"?(g.value=a.data.data.records,I.value=a.data.data.total):d.error("获取分类树失败"),f.value=!1},z=(a,e)=>{a.parentId===null&&e&&g.value.forEach(s=>{var u;s.categoryId!==a.categoryId&&((u=b.value)==null||u.toggleRowExpansion(s,!1))})},S=a=>{v.value=a,c()},T=a=>{_.value=a,v.value=1,c()};return j(()=>{c()}),(a,e)=>{const s=O,u=K,B=J,w=Z,y=Y,D=ee,P=X,R=G,U=H,$=q;return k(),F("div",ne,[C("div",re,[e[7]||(e[7]=C("h2",null,"商品类别管理",-1)),t(s,{type:"primary",onClick:e[0]||(e[0]=o=>h(null))},{default:n(()=>e[6]||(e[6]=[p("添加根分类")])),_:1})]),E((k(),A(B,{ref_key:"tableRef",ref:b,data:g.value,"tree-props":{children:"children",hasChildren:"hasChildren"},"row-key":"categoryId",style:{width:"100%",height:"90%"},onExpandChange:z,"row-style":{height:"70px"}},{default:n(()=>[t(u,{prop:"categoryName",label:"类别名称"}),t(u,{prop:"description",label:"描述"},{default:n(o=>[p(Q(o.row.description!==null?o.row.description:"null"),1)]),_:1}),t(u,{label:"操作",width:"200",align:"center"},{default:n(o=>[t(s,{size:"small",type:"primary",onClick:L=>h(o.row)},{default:n(()=>e[8]||(e[8]=[p("添加")])),_:2},1032,["onClick"]),E(t(s,{size:"small",onClick:L=>x(o.row),type:"info"},{default:n(()=>e[9]||(e[9]=[p("编辑")])),_:2},1032,["onClick"]),[[W,o.row.parentId]])]),_:1})]),_:1},8,["data"])),[[$,f.value]]),t(R,{modelValue:i.value,"onUpdate:modelValue":e[5]||(e[5]=o=>i.value=o),title:"类别信息",width:"500px"},{footer:n(()=>[C("span",se,[t(s,{onClick:e[4]||(e[4]=o=>i.value=!1)},{default:n(()=>e[10]||(e[10]=[p("取消")])),_:1}),t(s,{type:"primary",onClick:N},{default:n(()=>e[11]||(e[11]=[p("确定")])),_:1})])]),default:n(()=>[t(P,{model:l.value,"label-width":"100px"},{default:n(()=>[t(y,{label:"类别名称"},{default:n(()=>[t(w,{modelValue:l.value.categoryName,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.categoryName=o)},null,8,["modelValue"])]),_:1}),t(y,{label:"描述"},{default:n(()=>[t(w,{modelValue:l.value.description,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.description=o)},null,8,["modelValue"])]),_:1}),t(y,{label:"父类别"},{default:n(()=>[t(D,{modelValue:l.value.parentId,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.parentId=o),data:g.value,props:V.value,"check-strictly":!0,"allow-half-check":!0,placeholder:"请选择父类别",disabled:!m.value},null,8,["modelValue","data","props","disabled"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(U,{"current-page":v.value,"page-size":_.value,total:I.value,layout:"prev, pager, next",background:"",style:{"margin-top":"10px"},onCurrentChange:S,onSizeChange:T},null,8,["current-page","page-size","total"])])}}}),ye=ae(de,[["__scopeId","data-v-ca5382b8"]]);export{ye as default};
